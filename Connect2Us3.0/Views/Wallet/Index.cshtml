@model book2us.Models.Wallet

@{
    ViewBag.Title = "My Wallet";
}

<h2>My Wallet</h2>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["Success"]
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["Error"]
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
}

<div class="wallet-container">
    <div class="wallet-header">
        <h3>Current Balance</h3>
        <p class="balance-amount">$@Model.Balance.ToString("F2")</p>
        @if (Model.PendingBalance > 0)
        {
            <p class="pending-balance">Pending: $@Model.PendingBalance.ToString("F2")</p>
        }
    </div>

    <div class="wallet-stats">
        <div class="stat-item">
            <span class="stat-label">Wallet Status:</span>
            <span class="stat-value @(Model.IsActive ? "text-success" : "text-danger")">
                @(Model.IsActive ? "Active" : "Inactive")
            </span>
        </div>
        <div class="stat-item">
            <span class="stat-label">Created:</span>
            <span class="stat-value">@Model.CreatedDate.ToString("MMM dd, yyyy")</span>
        </div>
        @if (Model.LastTransactionDate.HasValue)
        {
            <div class="stat-item">
                <span class="stat-label">Last Transaction:</span>
                <span class="stat-value">@Model.LastTransactionDate.Value.ToString("MMM dd, yyyy")</span>
            </div>
        }
    </div>

    <div class="wallet-actions">
        <a href="@Url.Action("AddFunds", "Wallet")" class="btn btn-success btn-lg">
            <i class="fas fa-plus"></i> Add Funds
        </a>
        <a href="@Url.Action("Withdraw", "Wallet")" class="btn btn-warning btn-lg">
            <i class="fas fa-minus"></i> Withdraw
        </a>
    </div>

    <div class="wallet-navigation">
        <h4>Financial Management</h4>
        <div class="nav-buttons">
            <a href="@Url.Action("Index", "Banking")" class="btn btn-outline-primary">
                <i class="fas fa-university"></i> Manage Bank Accounts
            </a>
            <a href="@Url.Action("TransactionHistory", "Wallet")" class="btn btn-outline-info">
                <i class="fas fa-history"></i> Transaction History
            </a>
            <a href="@Url.Action("WithdrawalHistory", "Wallet")" class="btn btn-outline-secondary">
                <i class="fas fa-money-bill-wave"></i> Withdrawal History
            </a>
        </div>
    </div>

    @if (ViewBag.BankAccounts != null && ViewBag.BankAccounts.Count > 0)
    {
        <div class="linked-accounts">
            <h4>Linked Bank Accounts</h4>
            @foreach (var account in ViewBag.BankAccounts)
            {
                <div class="account-item">
                    <div class="account-info">
                        <strong>@account.BankName</strong>
                        <span>Account: ****@account.AccountNumber.Substring(Math.Max(0, account.AccountNumber.Length - 4))</span>
                        <span>Type: @account.AccountType</span>
                    </div>
                    <span class="status-badge @(account.IsActive ? "status-active" : "status-inactive")">
                        @(account.IsActive ? "Active" : "Inactive")
                    </span>
                </div>
            }
        </div>
    }

    @if (ViewBag.CardDetails != null && ViewBag.CardDetails.Count > 0)
    {
        <div class="linked-cards">
            <h4>Linked Cards</h4>
            @foreach (var card in ViewBag.CardDetails)
            {
                <div class="card-item">
                    <div class="card-info">
                        <strong>@card.CardType</strong>
                        <span>Card: ****@card.LastFourDigits</span>
                        <span>Expires: @card.ExpiryMonth/@card.ExpiryYear</span>
                    </div>
                    <div class="card-status">
                        @if (card.IsDefault)
                        {
                            <span class="default-badge">Default</span>
                        }
                        <span class="status-badge @(card.IsActive ? "status-active" : "status-inactive")">
                            @(card.IsActive ? "Active" : "Inactive")
                        </span>
                    </div>
                </div>
            }
        </div>
    }
</div>

<style>
    .wallet-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 30px;
        background-color: #ffffff;
        border-radius: 15px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .wallet-header {
        text-align: center;
        margin-bottom: 30px;
        padding: 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 10px;
    }

    .balance-amount {
        font-size: 3em;
        font-weight: bold;
        margin: 10px 0;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .pending-balance {
        font-size: 1.1em;
        opacity: 0.9;
        margin: 0;
    }

    .wallet-stats {
        display: flex;
        justify-content: space-around;
        margin-bottom: 30px;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
    }

    .stat-item {
        text-align: center;
    }

    .stat-label {
        display: block;
        font-size: 0.9em;
        color: #6c757d;
        margin-bottom: 5px;
    }

    .stat-value {
        display: block;
        font-weight: bold;
        font-size: 1.1em;
    }

    .wallet-actions {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 30px;
    }

    .wallet-navigation {
        margin-bottom: 30px;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
    }

    .nav-buttons {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 15px;
    }

    .linked-accounts, .linked-cards {
        margin-bottom: 20px;
    }

    .account-item, .card-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        margin-bottom: 10px;
        background-color: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #007bff;
    }

    .account-info, .card-info {
        flex: 1;
    }

    .account-info strong, .card-info strong {
        display: block;
        margin-bottom: 5px;
        color: #495057;
    }

    .account-info span, .card-info span {
        display: block;
        font-size: 0.9em;
        color: #6c757d;
    }

    .status-badge {
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.8em;
        font-weight: bold;
    }

    .status-active {
        background-color: #d4edda;
        color: #155724;
    }

    .status-inactive {
        background-color: #f8d7da;
        color: #721c24;
    }

    .default-badge {
        background-color: #007bff;
        color: white;
        padding: 3px 8px;
        border-radius: 10px;
        font-size: 0.7em;
        margin-right: 10px;
    }

    .card-status {
        display: flex;
        align-items: center;
    }
</style>

@section Scripts {
    <script src="https://kit.fontawesome.com/your-fontawesome-kit.js"></script>
}